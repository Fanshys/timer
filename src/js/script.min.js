"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Stopwatch=function(){function o(t,e){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0,0];_classCallCheck(this,o),this.name=e,this.running=!1,this.display=t,this.times=a,this.print(this.times)}return _createClass(o,[{key:"reset",value:function(){this.stop(),this.times=[0,0,0],this.print()}},{key:"start",value:function(){this.time||(this.time=performance.now()),this.running||(this.running=!0,requestAnimationFrame(this.step.bind(this)),setTimeout(localStor,5e3))}},{key:"stop",value:function(){this.running=!1,this.time=null}},{key:"step",value:function(t){this.running&&(this.calculate(t),this.time=t,this.print(),requestAnimationFrame(this.step.bind(this)))}},{key:"calculate",value:function(t){var e=t-this.time;this.times[2]+=e/1e3,60<=this.times[2]&&(this.times[1]+=1,this.times[2]-=60),60<=this.times[1]&&(this.times[0]+=1,this.times[1]-=60)}},{key:"print",value:function(){this.display.text(this.format(this.times))}},{key:"format",value:function(t){return"        ".concat(pad0(t[0],2),":        ").concat(pad0(t[1],2),":        ").concat(pad0(Math.floor(t[2]),2))}},{key:"getData",value:function(){return{name:this.name,time:this.times}}}]),o}();function pad0(t,e){for(var a=t.toString();a.length<e;--e)a="0"+a;return a}var stopwatch=[],i=0;function createStopwatch(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];$(".stopwatch__create").before('<div class="stopwatch-item row"><button class="stopwatch-item__delete"><i class="far fa-trash-alt"></i></button><div class="stopwatch-item__name-block col-12 col-md-6"><label><input class="stopwatch-item__name" value="'+t+'" readonly maxlength="15"><button class="stopwatch-item__name-icon"><i class="fas fa-pencil-alt"></i></button></label></div><div class="stopwatch-item__counter-block col-12 col-md-6" name="clockform"><span id="clock" class="stopwatch-item__counter stopwatch">00:00:00</span><div class="stopwatch-item__buttons"><button class="stopwatch-item__button start-button">Старт</button><button class="stopwatch-item__button pause-button">Пауза</button><button class="stopwatch-item__button reset-button">Сброс</button></div></div></div>'),stopwatch.push(new Stopwatch($(".stopwatch:eq(".concat(i,")")),t,e)),i++,$(".input__create").val(""),localStor()}var getDataStopwatch=function(){var e=[];return stopwatch.forEach(function(t){return e.push(t.getData())}),JSON.stringify(e)};function localStor(){var t=getDataStopwatch();localStorage.setItem("json",t)}workerTimers.setInterval(localStor,100),$(document).on("click",".start-button",function(){var t=$(this).index(".start-button");stopwatch[t].start(),localStor()}),$(document).on("click",".pause-button",function(){var t=$(this).index(".pause-button");stopwatch[t].stop(),localStor()}),$(document).on("click",".reset-button",function(){var t=$(this).index(".reset-button");stopwatch[t].reset(),localStor()}),$(document).on("click",".button__create",function(){createStopwatch($(".input__create").val()),localStor()}),$(document).on("click",".stopwatch-item__delete",function(){var t=$(this).index(".stopwatch-item__delete");stopwatch.splice(t,1),$(this).parent().remove(),i--,localStor()}),$(document).on("click",".stopwatch-item__name-icon",function(){var t=$(this).index(".stopwatch-item__name-icon");$(this).prev().attr("readonly")?($(this).html('<i class="fas fa-check"></i>'),$(this).prev().removeAttr("readonly").css("border-bottom","2px solid #00b3d6").css("color","white")):($(this).html('<i class="fas fa-pencil-alt"></i>'),$(this).prev().attr("readonly","readonly").css("border-bottom","none").css("color","#b4f5fd"),stopwatch[t].name=$(this).prev().val(),localStor())}),$(document).ready(function(){0<JSON.parse(localStorage.getItem("json")).length?JSON.parse(localStorage.getItem("json")).forEach(function(t){return createStopwatch(t.name,t.time)}):createStopwatch("Секундомер");$(document).on("keyup",".stopwatch-item__name",function(t){if(13==t.keyCode&&!$(this).attr("readonly")){var e=$(this).index(".stopwatch-item__name");$(this).next().html('<i class="fas fa-pencil-alt"></i>'),$(this).attr("readonly","readonly").css("border-bottom","none").css("color","#b4f5fd"),stopwatch[e].name=$(this).val(),localStor()}}),$(".input__create").keyup(function(t){13==t.keyCode&&(createStopwatch($(this).val()),localStor())})});